<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>secureBallot - Voting System</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Homepage -->
    <div id="homepage" class="page active">
        <!-- Navigation Bar -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo">üó≥Ô∏è secureBallot</div>
                <div class="nav-links">
                    <a href="#about" onclick="scrollToSection('about')">About</a>
                    <a href="#features" onclick="scrollToSection('features')">Features</a>
                    <a href="#how-it-works" onclick="scrollToSection('how-it-works')">How it Works</a>
                    <a href="#contact" onclick="scrollToSection('contact')">Contact</a>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <div class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">Your Voice Matters</h1>
                <p class="hero-subtitle">Cast your vote securely and transparently with secureBallot</p>
                <p class="hero-description">A modern, blockchain-inspired voting platform designed for fair and transparent elections. Every vote counts, every voice is heard.</p>
                
                <div class="hero-buttons">
                    <button class="btn btn-primary btn-large" onclick="navigateTo('candidateReg')">
                        üéØ Get Started as Candidate
                    </button>
                    <button class="btn btn-secondary btn-large" onclick="navigateTo('voterReg')">
                        üë• Register as Voter
                    </button>
                    <label class="btn btn-outline btn-large" for="importFileInput" style="cursor: pointer; margin-left: 8px;">
                        üìÅ Import Data
                    </label>
                    <input type="file" id="importFileInput" accept=".json,.csv,.txt" style="display:none" />
                </div>

                <div class="hero-stats">
                    <div class="stat-box">
                        <div class="stat-number" id="stat-candidates">0</div>
                        <div class="stat-label">Candidates</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="stat-voters">0</div>
                        <div class="stat-label">Voters</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="stat-votes">0</div>
                        <div class="stat-label">Votes Cast</div>
                    </div>
                </div>
            </div>
            <div class="hero-image">
                <div class="voting-box-animation">
                    <div class="ballot-card">üìã</div>
                    <div class="check-mark">‚úÖ</div>
                </div>
            </div>
        </div>

        <!-- About Section -->
        <div class="section" id="about">
            <div class="section-container">
                <h2 class="section-title">About secureBallot</h2>
                <div class="about-grid">
                    <div class="about-card">
                        <div class="card-icon">üîê</div>
                        <h3>Secure</h3>
                        <p>Military-grade encryption ensures your vote is private and protected from unauthorized access.</p>
                    </div>
                    <div class="about-card">
                        <div class="card-icon">üîç</div>
                        <h3>Transparent</h3>
                        <p>Real-time vote tracking and instant results ensure complete transparency in the voting process.</p>
                    </div>
                    <div class="about-card">
                        <div class="card-icon">‚ö°</div>
                        <h3>Lightning Fast</h3>
                        <p>Instant vote registration and results display. No delays, pure efficiency.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="section section-alt" id="features">
            <div class="section-container">
                <h2 class="section-title">Powerful Features</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-number">01</div>
                        <h3>Candidate Registration</h3>
                        <p>Easy candidate registration with party details, symbols, and biography. Build your campaign profile in minutes.</p>
                        <button class="btn btn-outline" onclick="navigateTo('candidateReg')">Register Now</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">02</div>
                        <h3>Voter Verification</h3>
                        <p>Secure voter registration system with age verification and unique Voter ID. Only eligible voters can participate.</p>
                        <button class="btn btn-outline" onclick="navigateTo('voterReg')">Join Now</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">03</div>
                        <h3>Secure Voting (2FA)</h3>
                        <p>Two-factor authentication ensures only authorized voters can cast votes. OTP verification for security.</p>
                        <button class="btn btn-outline" onclick="navigateTo('votingSecure')">Vote Securely</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">04</div>
                        <h3>Vote Verification</h3>
                        <p>Verify your vote receipt to confirm your vote was counted. End-to-end verifiable elections.</p>
                        <button class="btn btn-outline" onclick="navigateTo('verifyReceipt')">Verify</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">05</div>
                        <h3>Live Results</h3>
                        <p>Real-time election results with detailed statistics, vote percentages, and voter turnout information.</p>
                        <button class="btn btn-outline" onclick="navigateTo('results')">View Results</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">06</div>
                        <h3>Admin Panel</h3>
                        <p>Configure elections, manage bulk voters, view audit logs, and access security dashboards.</p>
                        <button class="btn btn-outline" onclick="navigateTo('adminSettings')">Admin Tools</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">07</div>
                        <h3>Bulk Voter Management</h3>
                        <p>Import/export voter lists, manage registrations in bulk, and view import history.</p>
                        <button class="btn btn-outline" onclick="navigateTo('voterBulkManage')">Manage Voters</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">08</div>
                        <h3>Audit Dashboard</h3>
                        <p>View 2FA audit logs, voting receipts ledger, and export data for compliance.</p>
                        <button class="btn btn-outline" onclick="navigateTo('adminAudit')">View Audit</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">09</div>
                        <h3>Data Security</h3>
                        <p>Your data is stored locally in your browser. No external servers, complete privacy and control.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-number">10</div>
                        <h3>Mobile Friendly</h3>
                        <p>Responsive design that works perfectly on desktop, tablet, and mobile devices. Vote from anywhere.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- How It Works Section -->
        <div class="section" id="how-it-works">
            <div class="section-container">
                <h2 class="section-title">How It Works</h2>
                <div class="steps-container">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>Register</h3>
                        <p>Candidates and voters register their information through simple forms.</p>
                    </div>
                    <div class="step-arrow">‚Üí</div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>Verify</h3>
                        <p>System verifies voter eligibility and candidate credentials.</p>
                    </div>
                    <div class="step-arrow">‚Üí</div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>Vote</h3>
                        <p>Voters cast their vote securely using Voter ID authentication.</p>
                    </div>
                    <div class="step-arrow">‚Üí</div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <h3>Results</h3>
                        <p>Live results are displayed in real-time with detailed analytics.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Call to Action Section -->
        <div class="section section-alt cta-section" id="contact">
            <div class="section-container">
                <h2 class="section-title">Ready to Vote?</h2>
                <p class="cta-subtitle">Join thousands of voters participating in secure, transparent elections.</p>
                
                <div class="cta-buttons">
                    <button class="btn btn-primary btn-large" onclick="navigateTo('candidateReg')">
                        üéØ Register as Candidate
                    </button>
                    <button class="btn btn-secondary btn-large" onclick="navigateTo('voterReg')">
                        üë• Register as Voter
                    </button>
                    <button class="btn btn-info btn-large" onclick="navigateTo('votingSecure')">
                        üîê Cast Vote (Secure)
                    </button>
                    <button class="btn btn-success btn-large" onclick="navigateTo('results')">
                        üìä View Results
                    </button>
                    <button class="btn btn-outline btn-large" onclick="navigateTo('verifyReceipt')">
                        üé´ Verify Receipt
                    </button>
                    <button class="btn btn-primary btn-large" onclick="navigateTo('adminSettings')">
                        ‚öôÔ∏è Admin Panel
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-container">
                <div class="footer-content">
                    <h3>secureBallot</h3>
                    <p>Secure, transparent, and democratic voting for everyone.</p>
                </div>
                <div class="footer-links">
                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <a href="#" onclick="navigateTo('candidateReg')">Register Candidate</a>
                        <a href="#" onclick="navigateTo('voterReg')">Register Voter</a>
                        <a href="#" onclick="navigateTo('voting')">Vote</a>
                        <a href="#" onclick="navigateTo('results')">Results</a>
                    </div>
                    <div class="footer-section">
                        <h4>Information</h4>
                        <a href="#about" onclick="scrollToSection('about')">About Us</a>
                        <a href="#features" onclick="scrollToSection('features')">Features</a>
                        <a href="#how-it-works" onclick="scrollToSection('how-it-works')">How It Works</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 secureBallot. All rights reserved. | Built with ‚ù§Ô∏è for democracy</p>
            </div>
        </footer>
    </div>

    <!-- Candidate Registration Page -->
    <div id="candidateReg" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>Candidate Registration</h1>
            
            <form id="candidateForm" onsubmit="registerCandidate(event)">
                <div class="form-group">
                    <label for="candidateName">Full Name:</label>
                    <input type="text" id="candidateName" required>
                </div>

                <div class="form-group">
                    <label for="candidateParty">Party Name:</label>
                    <input type="text" id="candidateParty" required>
                </div>

                <div class="form-group">
                    <label for="candidateSymbol">Party Symbol:</label>
                    <input type="text" id="candidateSymbol" placeholder="e.g., Lion, Tiger, etc." required>
                </div>

                <div class="form-group">
                    <label for="candidateBio">Biography:</label>
                    <textarea id="candidateBio" rows="4" required></textarea>
                </div>

                <button type="submit" class="btn btn-primary">Register Candidate</button>
            </form>

            <div id="candidateList" class="candidate-list"></div>
        </div>
    </div>

    <!-- Voter Registration Page -->
    <div id="voterReg" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>Voter Registration</h1>
            
            <form id="voterForm" onsubmit="registerVoter(event)">
                <div class="form-group">
                    <label for="voterName">Full Name:</label>
                    <input type="text" id="voterName" required>
                </div>

                <div class="form-group">
                    <label for="voterEmail">Email:</label>
                    <input type="email" id="voterEmail" required>
                </div>

                <div class="form-group">
                    <label for="voterAge">Age:</label>
                    <input type="number" id="voterAge" min="18" required>
                </div>

                <div class="form-group">
                    <label for="voterId">Voter ID:</label>
                    <input type="text" id="voterId" placeholder="e.g., VID-12345" required>
                </div>

                <button type="submit" class="btn btn-primary">Register as Voter</button>
            </form>
            <!-- Voter list moved to Manage Users page -->
        </div>
    </div>

    <!-- Manage Users Page (Registered Users with timestamps) -->
    <div id="manageUsers" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>Registered Users</h1>

            <div id="manageVoterList" class="voter-list"></div>
        </div>
    </div>

    <!-- Voting Page -->
    <div id="voting" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>Cast Your Vote</h1>
            
            <div class="voting-container">
                <form id="votingForm" onsubmit="castVote(event)">
                    <div class="form-group">
                        <label for="votingVoterId">Your Voter ID:</label>
                        <input type="text" id="votingVoterId" placeholder="Enter your Voter ID" required>
                    </div>

                    <div class="form-group">
                        <label>Select Your Candidate:</label>
                        <div id="candidateOptions" class="candidates-grid"></div>
                    </div>

                    <button type="submit" class="btn btn-primary">Cast Vote</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Result Page -->
    <div id="results" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>Election Results</h1>
            
            <div id="resultsContainer" class="results-container"></div>
            <div id="totalVotes" class="total-votes"></div>
        </div>
    </div>

    <!-- Election Settings Page -->
    <div id="adminSettings" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>‚öôÔ∏è Election Settings</h1>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px;">
                <div>
                    <h2 style="margin-top: 0;">Configure Election</h2>
                    <form onsubmit="saveElectionSettings(event)">
                        <div class="form-group">
                            <label>Election Name:</label>
                            <input type="text" id="electionName" required>
                        </div>
                        <div class="form-group">
                            <label>Start Time:</label>
                            <input type="datetime-local" id="electionStartTime">
                        </div>
                        <div class="form-group">
                            <label>End Time:</label>
                            <input type="datetime-local" id="electionEndTime">
                        </div>
                        <div class="form-group">
                            <label>Ballot Type:</label>
                            <select id="ballotType">
                                <option value="single-choice">Single Choice</option>
                                <option value="multi-choice">Multi-Choice</option>
                                <option value="ranked-choice">Ranked Choice</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Quorum Percentage (%):</label>
                            <input type="number" id="quorumPercentage" min="0" max="100" value="0">
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="allowVoterEdit" checked>
                                Allow Voters to Edit Their Details
                            </label>
                        </div>
                        <div class="form-group">
                            <label>Max Candidate Selections:</label>
                            <input type="number" id="maxCandidateSelections" min="1" value="1">
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="allowAbstain">
                                Allow Abstain Option
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Settings</button>
                    </form>
                </div>

                <div>
                    <div id="electionSettingsDisplay"></div>
                    <h3 style="margin-top: 30px;">Import/Export</h3>
                    <p>
                        <button class="btn btn-secondary" onclick="exportElectionConfig()" style="width:100%; margin-bottom:10px;">
                            üì• Export Configuration
                        </button>
                    </p>
                    <p>
                        <label class="btn btn-secondary" for="configImportInput" style="width:100%; cursor:pointer; text-align:center; display:block;">
                            üì§ Import Configuration
                        </label>
                        <input type="file" id="configImportInput" accept=".json" style="display:none;" onchange="importElectionConfig(this.files[0])">
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Voter 2FA & Receipt Page -->
    <div id="votingSecure" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('voting')">‚Üê Back</button>
            <h1>üîê Secure Voting (2FA)</h1>

            <div style="background: #f0f9ff; border: 2px solid #0284c7; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                <h3 style="margin-top: 0;">Step 1: Verify Your Email (2FA)</h3>
                <div class="form-group">
                    <label>Your Email:</label>
                    <input type="email" id="twoFAEmail" placeholder="Enter your registered email" required>
                </div>
                <button class="btn btn-primary" onclick="sendOTP(document.getElementById('twoFAEmail').value)">
                    Send OTP
                </button>
            </div>

            <div style="background: #f0f9ff; border: 2px solid #0284c7; padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0;">Step 2: Enter OTP</h3>
                <div class="form-group">
                    <label>One-Time Password (OTP):</label>
                    <input type="text" id="otpInput" placeholder="Enter 6-digit OTP" maxlength="6" required>
                </div>
                <button class="btn btn-success" onclick="validateAndContinueVoting()">
                    Verify & Continue
                </button>
            </div>
        </div>
    </div>

    <!-- Receipt Verification Page -->
    <div id="verifyReceipt" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>üé´ Verify Your Vote Receipt</h1>

            <div style="max-width: 600px; margin: 0 auto;">
                <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <h3 style="margin-top: 0;">Check Your Vote</h3>
                    <p>Enter your Receipt ID (provided after voting) to verify your vote is included in the election ledger.</p>
                    <div class="form-group">
                        <label>Receipt ID:</label>
                        <input type="text" id="verifyReceiptId" placeholder="e.g., A3F2B1C9D5E8" style="font-family: monospace;">
                    </div>
                    <button class="btn btn-primary" onclick="verifyVotingReceipt()">
                        Verify Receipt
                    </button>
                </div>

                <div id="verifyReceiptResult" style="min-height: 50px;"></div>
            </div>
        </div>
    </div>

    <!-- Bulk Voter Import/Export Page -->
    <div id="voterBulkManage" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>üì• Bulk Voter Management</h1>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div>
                    <h3>Import Voters from CSV</h3>
                    <p style="font-size: 0.95em; color: #666;">Upload a CSV file with columns: name, email, voterId, age</p>
                    <label class="btn btn-primary" for="bulkVoterImport" style="cursor: pointer; display: block; text-align: center; margin-bottom: 10px;">
                        üì§ Choose CSV File
                    </label>
                    <input type="file" id="bulkVoterImport" accept=".csv" style="display:none;" onchange="validateVoterCSV(this.files[0])">

                    <p>
                        <button class="btn btn-outline" onclick="downloadSampleVoterCSV()">
                            üìã Download Sample CSV
                        </button>
                    </p>

                    <div id="voterImportLogContainer" style="margin-top: 20px;"></div>
                </div>

                <div>
                    <h3>Export Voters</h3>
                    <p style="font-size: 0.95em; color: #666;">Download all registered voters as a CSV file.</p>
                    <button class="btn btn-secondary" onclick="exportVotersAsCSV()" style="width: 100%; margin-bottom: 10px;">
                        üì• Export Voters as CSV
                    </button>

                    <h3 style="margin-top: 30px;">Quick Actions</h3>
                    <button class="btn btn-outline" onclick="displayVoterImportLog()" style="width: 100%;">
                        View Import History
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Audit Dashboard -->
    <div id="adminAudit" class="page">
        <div class="container">
            <button class="back-btn" onclick="navigateTo('homepage')">‚Üê Back</button>
            <h1>üìä Admin Audit Dashboard</h1>

            <div style="margin-bottom: 40px;">
                <h3>üîê 2FA Audit Log</h3>
                <button class="btn btn-secondary" onclick="display2FAAuditLog()" style="margin-bottom: 10px;">
                    Refresh 2FA Log
                </button>
                <button class="btn btn-outline" onclick="clear2FAAuditLog()">
                    Clear Log
                </button>
                <div id="twoFAAuditContainer" style="margin-top: 15px;"></div>
            </div>

            <div style="margin-bottom: 40px;">
                <h3>üé´ Voting Receipts Ledger</h3>
                <button class="btn btn-secondary" onclick="displayVotingReceiptsAdmin()" style="margin-bottom: 10px;">
                    Refresh Receipts
                </button>
                <button class="btn btn-primary" onclick="exportVotingReceiptsAudit()">
                    Export as CSV
                </button>
                <div id="votingReceiptsAdminContainer" style="margin-top: 15px;"></div>
            </div>
        </div>
    </div>

    <script src="js/voter.js"></script>
    <script src="js/candidate.js"></script>
    <script src="js/voting.js"></script>
    <script src="js/import.js"></script>
    <script src="js/twofa.js"></script>
    <script src="js/verifiable.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/receipt.js"></script>
    <script src="js/bulk-voter.js"></script>
    <script src="js/voting-enhanced.js"></script>
    <script src="js/results.js"></script>
</body>
</html>
